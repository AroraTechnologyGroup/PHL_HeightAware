//>>built
var __extends=this&&this.__extends||function(){var k=function(g,h){k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,e){c.__proto__=e}||function(c,e){for(var g in e)e.hasOwnProperty(g)&&(c[g]=e[g])};return k(g,h)};return function(g,h){function c(){this.constructor=g}k(g,h);g.prototype=null===h?Object.create(h):(c.prototype=h.prototype,new c)}}(),__decorate=this&&this.__decorate||function(k,g,h,c){var e=arguments.length,l=3>e?g:null===c?c=Object.getOwnPropertyDescriptor(g,h):c,m;
if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)l=Reflect.decorate(k,g,h,c);else for(var n=k.length-1;0<=n;n--)if(m=k[n])l=(3>e?m(l):3<e?m(g,h,l):m(g,h))||l;return 3<e&&l&&Object.defineProperty(g,h,l),l};
define("require exports esri/core/tsSupport/declareExtendsHelper esri/core/tsSupport/decorateHelper esri/widgets/support/widget esri/core/Accessor esri/core/watchUtils dstore/Memory esri/symbols/PolygonSymbol3D esri/Color esri/symbols/FillSymbol3DLayer esri/core/accessorSupport/decorators".split(" "),function(k,g,h,c,e,l,m,n,q,r,t,d){Object.defineProperty(g,"__esModule",{value:!0});k=function(g){function b(a){a=g.call(this,a)||this;a.store3d=new n({data:[]});a.store2d=new n({data:[]});m.whenOnce(a,
"view").then(a.onload.bind(a));return a}h(b,g);b.prototype.onload=function(){};b.prototype.create3DArray=function(a,c,f){a=a.map(function(a){var b=a.attributes.Elev,p,d;p=Number((b-c).toFixed(1));d=Number((p-f).toFixed(1));return{oid:a.attributes.OBJECTID,name:a.attributes.layerName,type:a.attributes["OIS Surface Type"],condition:a.attributes["OIS Surface Condition"],runwayend:a.attributes["Runway End Designator"],runway:a.attributes["Runway Designator"],elevation:b,height:p,clearance:d,guidance:a.attributes["Approach Guidance"],
dateacquired:a.attributes["Date Data Acquired"],description:a.attributes.Description,regulation:a.attributes["Safety Regulation"],zoneuse:a.attributes["Zone Use"]}}).slice(0);a.sort(function(a,f){return a.clearance<f.clearance?-1:a.clearance>f.clearance?1:0});this.store3d.setData(a);return a};b.prototype.create2DArray=function(a){a=a.map(function(a){return{oid:a.attributes.OBJECTID,layerName:a.attributes.layerName,name:a.attributes.Name,description:a.attributes.Description,date:a.attributes["Date Data Acquired"],
datasource:a.attributes["Data Source"],lastupdate:a.attributes["Last Update"]}}).slice(0);a.sort(function(a,f){return a.name<f.name?1:a.name>f.name?-1:0});this.store2d.setData(a);return a};b.prototype.enableGrid3dEvents=function(){var a=this;this.grid3d_select=this.results3d_grid.on("dgrid-select",function(b){console.log(b);b.rows.forEach(function(f){var b=f.data.name.toLowerCase();f=parseInt(f.data.oid);-1!==Object.keys(a.selected_feature_visibility).indexOf(b)?(b=a.selected_feature_visibility[b],
-1===b.indexOf(f)&&b.push(f)):(console.log("layer not initially set in the selected feature visibility object after watching the default layer visibility"),a.selected_feature_visibility[b]=[f])});a.updateFeatureDef()});this.grid3d_deselect=this.results3d_grid.on("dgrid-deselect",function(b){console.log(b);b.rows.forEach(function(b){var f=b.data.name.toLowerCase();b=parseInt(b.data.oid);if(-1!==Object.keys(a.selected_feature_visibility).indexOf(f)){var f=a.selected_feature_visibility[f],c=f.indexOf(b);
-1!==c&&(f.splice(c,1),-1!==f.indexOf(b)?console.log("The object id was not removed from the list"):console.log("The object id "+b+" was removed"))}});a.updateFeatureDef()})};b.prototype.removeGrid3dEvents=function(){this.grid3d_select&&this.grid3d_select.remove();this.grid3d_deselect&&this.grid3d_deselect.remove()};b.prototype.enableGrid2dEvents=function(){var a=this;this.grid2d_select=this.results2d_grid.on("dgrid-select",function(b){console.log(b);b.rows.forEach(function(b){var f=b.data.layerName.toLowerCase(),
c=parseInt(b.data.oid);b=a.scene.findLayerById(f);a.view.whenLayerView(b).then(function(b){a.highlight2d&&a.highlight2d.remove();a.highlight2d=b.highlight(c)})})});this.grid2d_deselect=this.results2d_grid.on("dgrid-deselect",function(b){console.log(b);b.rows.forEach(function(b){a.highlight2d&&a.highlight2d.remove()})})};b.prototype.removeGrid2dEvents=function(){this.grid2d_select&&this.grid2d_select.remove();this.grid2d_deselect&&this.grid2d_deselect.remove()};b.prototype.updateFeatureDef=function(){var b=
this,c=this.selected_feature_visibility,f=!1;Object.keys(c).forEach(function(a){var d=b.scene.findLayerById(a.toLowerCase());c[a].length?(a=c[a].join(","),d.definitionExpression="OBJECTID IN ("+a+")",b.set3DSymbols(d,!0),f=d.visible=!0):(d.definitionExpression="OBJECTID IS NULL",d.visible=!1)});f||this.getDefaultLayerVisibility()};b.prototype.getDefaultLayerVisibility=function(){var b=this;this.defaultLayerVisibility.forEach(function(a){var c=b.scene.findLayerById(a.id);c.visible=a.def_visible;c.definitionExpression=
a.def_exp;b.set3DSymbols(c,!1)})};b.prototype.set3DSymbols=function(b,c){var a=b.renderer.type,d=new r({r:0,g:0,b:0,a:0});if("simple"===a)a=void 0,a=b.renderer,a=a.symbol,a="simple-fill"===a.type?a.outline.color:a.symbolLayers.getItemAt(0).outline.color,c&&(d=a),a={type:"simple",symbol:{type:"polygon-3d",symbolLayers:[{type:"fill",material:{color:d},outline:{color:a,size:"4px"}}]}},b.set("renderer",a);else if("unique-value"===a){var a=b.renderer,e=a.uniqueValueInfos,g=e.some(function(a){if("polygon-3d"===
a.symbol.type)return!0}),h=[],k;e.forEach(function(a){var b=a.value;if(g)e=a.symbol,k=e.symbolLayers.getItemAt(0).outline.color;else{var e=a.symbol;k=e.outline.color}c&&(d=k);e=new q({symbolLayers:[new t({material:{color:d},outline:{color:k,size:"4px"}})]});h.push({value:b,symbol:e,label:a.label})});a={type:"unique-value",field:a.field,defaultSymbol:a.defaultSymbol,uniqueValueInfos:h};b.set("renderer",a)}b.opacity=c?.75:1;return b};c([e.renderable(),d.property()],b.prototype,"name",void 0);c([e.renderable(),
d.property()],b.prototype,"x",void 0);c([e.renderable(),d.property()],b.prototype,"y",void 0);c([e.renderable(),d.property()],b.prototype,"msl",void 0);c([e.renderable(),d.property()],b.prototype,"agl",void 0);c([e.renderable(),d.property()],b.prototype,"ground_elevation",void 0);c([e.renderable(),d.property()],b.prototype,"elevation_change",void 0);c([e.renderable(),d.property()],b.prototype,"dem_source",void 0);c([e.renderable(),d.property()],b.prototype,"layerResults3d",void 0);c([e.renderable(),
d.property()],b.prototype,"layerResults2d",void 0);c([e.renderable(),d.property()],b.prototype,"count_3d",void 0);c([e.renderable(),d.property()],b.prototype,"count_2d",void 0);c([e.renderable(),d.property()],b.prototype,"results3d_grid",void 0);c([e.renderable(),d.property()],b.prototype,"results2d_grid",void 0);c([e.renderable(),d.property()],b.prototype,"selected_feature_visibility",void 0);c([d.property()],b.prototype,"modifiedBase",void 0);c([d.property()],b.prototype,"scene",void 0);c([d.property()],
b.prototype,"view",void 0);c([d.property()],b.prototype,"defaultLayerVisibility",void 0);c([d.property()],b.prototype,"expand",void 0);c([d.property()],b.prototype,"store3d",void 0);c([d.property()],b.prototype,"store2d",void 0);c([d.property()],b.prototype,"highlight2d",void 0);c([d.property()],b.prototype,"grid3d_select",void 0);c([d.property()],b.prototype,"grid3d_deselect",void 0);c([d.property()],b.prototype,"grid2d_select",void 0);c([d.property()],b.prototype,"grid2d_deselect",void 0);return b=
c([d.subclass("widgets.App.ObstructionViewModel")],b)}(d.declared(l));g.default=k});