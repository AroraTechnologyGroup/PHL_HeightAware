//>>built
var __extends=this&&this.__extends||function(){var k=function(f,g){k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,c){b.__proto__=c}||function(b,c){for(var f in c)c.hasOwnProperty(f)&&(b[f]=c[f])};return k(f,g)};return function(f,g){function b(){this.constructor=f}k(f,g);f.prototype=null===g?Object.create(g):(b.prototype=g.prototype,new b)}}(),__decorate=this&&this.__decorate||function(k,f,g,b){var c=arguments.length,l=3>c?f:null===b?b=Object.getOwnPropertyDescriptor(f,g):b,m;
if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)l=Reflect.decorate(k,f,g,b);else for(var n=k.length-1;0<=n;n--)if(m=k[n])l=(3>c?m(l):3<c?m(f,g,l):m(f,g))||l;return 3<c&&l&&Object.defineProperty(f,g,l),l};
define("require exports esri/core/tsSupport/declareExtendsHelper esri/core/tsSupport/decorateHelper esri/core/accessorSupport/decorators esri/widgets/Widget dojo/aspect dojo/query dojo/_base/declare dojo/dom-class dgrid/Grid dgrid/extensions/ColumnHider dgrid/Selection dstore/Memory ./viewModels/ObstructionResultsViewModel esri/widgets/support/widget".split(" "),function(k,f,g,b,c,l,m,n,p,h,q,r,t,u,v,e){Object.defineProperty(f,"__esModule",{value:!0});k=function(f){function d(a){a=f.call(this,a)||
this;a.viewModel=new v.default;a.x=0;a.y=0;a.agl=0;a.msl=0;a.name="Obstruction Results";a.ground_elevation=0;a.elevation_change=0;a.modifiedBase=!1;a.count_3d=0;a.count_2d=0;a.store3d=new u({data:[]});a.store2d=new u({data:[]});a.defaultLayerVisibility=[];a.selected_feature_visibility={};return a}g(d,f);Object.defineProperty(d.prototype,"dem_source_change",{get:function(){return this.modifiedBase?this.dem_source+" ("+this.elevation_change.toFixed(2)+" ft.)":""+this.dem_source},enumerable:!0,configurable:!0});
d.prototype.postInitialize=function(){var a=this,b=this.watch("layerResults3d",function(b,c,d,e){a.count_3d=b.features.length;b=a.viewModel.create3DArray(b.features,a.ground_elevation,a.agl);console.log(b);a.viewModel.removeGrid3dEvents();a.results3d_grid.set("collection",a.store3d.data);a.results3d_grid.refresh();a.results3d_grid.renderArray(a.store3d.data);a.viewModel.enableGrid3dEvents();a.results3d_grid.resize()}),c=this.watch("layerResults2d",function(b,c,d,e){a.count_2d=b.features.length;b=
a.viewModel.create2DArray(b.features);console.log(b);a.viewModel.removeGrid2dEvents();a.results2d_grid.set("collection",a.store2d.data);a.results2d_grid.refresh();a.results2d_grid.renderArray(a.store2d.data);a.viewModel.enableGrid2dEvents();a.results2d_grid.resize()}),d=this.watch("defaultLayerVisibility",function(b){a.selected_feature_visibility={};b.forEach(function(b){a.selected_feature_visibility[b.id]=[]})});this.own([b,c,d])};d.prototype.Click3d=function(a){if(!h.contains(a.target,"is-active")){a=
document.getElementById("tab_3d");var b=document.getElementById("results3d"),c=document.getElementById("tab_2d"),d=document.getElementById("results2d");h.add(a,"is-active");h.add(b,"is-active");h.remove(c,"is-active");h.remove(d,"is-active")}this.results3d_grid.resize()};d.prototype.Click2d=function(a){if(!h.contains(a.target,"is-active")){a=document.getElementById("tab_3d");var b=document.getElementById("results3d"),c=document.getElementById("tab_2d"),d=document.getElementById("results2d");h.add(c,
"is-active");h.add(d,"is-active");h.remove(a,"is-active");h.remove(b,"is-active")}this.results2d_grid.resize()};d.prototype.buildResults3d=function(a){a=this.results3d_grid=new (p([q,t,r]))({columns:{oid:{label:"Object ID",hidden:!0},clearance:{label:"Clearance (+ / - ft.)",className:"data-field",unhideable:!0},name:{label:"Surface Name",className:"data-field",unhideable:!0},type:{label:"Type",className:"data-field"},condition:{label:"Condition",className:"data-field",hidden:!0},runwayend:{label:"Runway End",
className:"data-field"},runway:{label:"Runway",className:"data-field"},elevation:{label:"MSL (ft.)",className:"data-field"},height:{label:"AGL (ft.)",className:"data-field"},guidance:{label:"Approach Guidance",className:"metadata-field",hidden:!0},dateacquired:{label:"Date Acquired",className:"metadata-field",hidden:!0},description:{label:"Description",className:"metadata-field",hidden:!0},regulation:{label:"Safety Regulation",className:"metadata-field",hidden:!0},zoneuse:{label:"Zone Use",className:"metadata-field",
hidden:!0}},deselectOnRefresh:!0},a);m.after(a,"renderRow",function(a,b){try{if(0>=parseFloat(b[0].clearance)){var c=n(".dgrid-cell.field-clearance",a);c.length&&h.add(c[0],"negative")}}catch(w){console.log(w)}return a});a.startup()};d.prototype.buildResults2d=function(a){(this.results2d_grid=new (p([q,t,r]))({columns:{oid:{label:"Object ID",hidden:!0},layerName:{label:"Layer Name",hidden:!0},name:{label:"Surface Name",unhideable:!0,className:"data-field"},description:{label:"Description",className:"data-field"},
date:{label:"Date Acquired",className:"metadata-field",hidden:!0},datasource:{label:"Data Source",className:"metadata-field",hidden:!0},lastupdate:{label:"Last Update",className:"metadata-field",hidden:!0}},selectionMode:"single",deselectOnRefresh:!0},a)).startup()};d.prototype.toggleMetadata=function(a){var b=this;"type condition runway elevation height guidance dateacquired description regulation zoneuse".split(" ").forEach(function(a){b.results3d_grid.toggleColumnHiddenState(a)});["description",
"date","datasource","lastupdate"].forEach(function(a){b.results2d_grid.toggleColumnHiddenState(a)});h.toggle(a.target,"metadata-selected")};d.prototype.render=function(){return e.tsx("div",{id:"obstructionResults",class:"esri-widget"},e.tsx("span",{class:"icon-ui-organization","aria-hidden":"true"}),e.tsx("span",{class:"panel-label"},e.tsx("b",null,this.name)),e.tsx("div",{class:"obstruction-params"},e.tsx("b",null,"x:")," ",this.x," feet",e.tsx("br",null),e.tsx("b",null,"y:")," ",this.y," feet",
e.tsx("br",null),e.tsx("b",null,"Ground Elevation:")," ",this.ground_elevation," feet MSL ",e.tsx("i",null,"source:",this.dem_source_change),e.tsx("br",null),e.tsx("b",null,"Obstruction Height AGL:")," ",this.agl," feet",e.tsx("br",null),e.tsx("b",null,"Obstruction Elevation MSL:")," ",this.msl," feet",e.tsx("br",null)),e.tsx("div",{class:"js-tab-group"},e.tsx("nav",{class:"tab-nav"},e.tsx("a",{id:"tab_3d",class:"tab-title is-active",onclick:this.Click3d.bind(this)},"3D Surfaces (",this.count_3d,
")"),e.tsx("a",{id:"tab_2d",class:"tab-title",onclick:this.Click2d.bind(this)},"2D Surfaces (",this.count_2d,")"),e.tsx("a",{id:"metadata",class:"tab-title",onclick:this.toggleMetadata.bind(this)},"metadata fields")),e.tsx("section",{class:"tab-contents"},e.tsx("article",{id:"results3d",class:"results_panel tab-section js-tab-section is-active"},e.tsx("div",{afterCreate:this.buildResults3d.bind(this)})),e.tsx("article",{id:"results2d",class:"results_panel tab-section js-tab-section"},e.tsx("div",
{afterCreate:this.buildResults2d.bind(this)})))))};b([c.property()],d.prototype,"viewModel",void 0);b([c.aliasOf("viewModel.scene")],d.prototype,"scene",void 0);b([c.aliasOf("viewModel.view")],d.prototype,"view",void 0);b([c.aliasOf("viewModel.x")],d.prototype,"x",void 0);b([c.aliasOf("viewModel.y")],d.prototype,"y",void 0);b([c.aliasOf("viewModel.agl")],d.prototype,"agl",void 0);b([c.aliasOf("viewModel.msl")],d.prototype,"msl",void 0);b([c.aliasOf("viewModel.name")],d.prototype,"name",void 0);b([c.aliasOf("viewModel.ground_elevation")],
d.prototype,"ground_elevation",void 0);b([c.aliasOf("viewModel.elevation_change")],d.prototype,"elevation_change",void 0);b([c.aliasOf("viewModel.modifiedBase")],d.prototype,"modifiedBase",void 0);b([c.aliasOf("viewModel.dem_source")],d.prototype,"dem_source",void 0);b([c.aliasOf("viewModel.layerResults3d")],d.prototype,"layerResults3d",void 0);b([c.aliasOf("viewModel.layerResults2d")],d.prototype,"layerResults2d",void 0);b([c.aliasOf("viewModel.count_3d")],d.prototype,"count_3d",void 0);b([c.aliasOf("viewModel.count_2d")],
d.prototype,"count_2d",void 0);b([c.aliasOf("viewModel.expand")],d.prototype,"expand",void 0);b([c.aliasOf("viewModel.results3d_grid")],d.prototype,"results3d_grid",void 0);b([c.aliasOf("viewModel.results2d_grid")],d.prototype,"results2d_grid",void 0);b([c.aliasOf("viewModel.store3d")],d.prototype,"store3d",void 0);b([c.aliasOf("viewModel.store2d")],d.prototype,"store2d",void 0);b([c.aliasOf("viewModel.defaultLayerVisibility")],d.prototype,"defaultLayerVisibility",void 0);b([c.aliasOf("viewModel.selected_feature_visibility")],
d.prototype,"selected_feature_visibility",void 0);b([c.aliasOf("viewModel.highlight2d")],d.prototype,"highlight2d",void 0);return d=b([c.subclass("app.widgets.obstructionResults")],d)}(c.declared(l));f.ObstructionResults=k});